import{_ as ge}from"./7.jKjWACjA.js";import{a as Se,n as Sr,t as Ne}from"./disclose-version.CUipO8R4.js";import"./legacy.BaD-mR7Z.js";import{k as Er,l as Tr,K as Or,M as Wt,N as Zt,P as I,g as $,O as be,Q as E,R as T,I as A,aJ as Ar,aK as Pr,J as Lr,h as jr}from"./runtime.BIfulsMb.js";import{i as Qt}from"./lifecycle.Dqr-ogBj.js";import{s as $r,b as Rr,p as xr}from"./props.Dep3xOnE.js";import{a as Xt}from"./index-client.xH2b0Xgx.js";import{e as O}from"./events.BnTA9Y8R.js";import{i as Ir}from"./if.BaJK5kSS.js";import{s as q}from"./attributes.c0VoCUeN.js";import{s as Ur,g as Dr,c as qr}from"./entry.DO1OaZvV.js";function Mr(n,e,t,r,s){var o;Er&&Tr();var i=(o=e.$$slots)==null?void 0:o[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}function te(n,e,t){if(t){if(n.classList.contains(e))return;n.classList.add(e)}else{if(!n.classList.contains(e))return;n.classList.remove(e)}}function re(n){return function(...e){var t=e[0];return t.preventDefault(),n==null?void 0:n.apply(this,e)}}const Nr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ge(async()=>{const{default:r}=await Promise.resolve().then(()=>pe);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class nt extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Br extends nt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Hr extends nt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Fr extends nt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Xe;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Xe||(Xe={}));var zr=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{h(r.next(c))}catch(u){a(u)}}function l(c){try{h(r.throw(c))}catch(u){a(u)}}function h(c){c.done?i(c.value):s(c.value).then(o,l)}h((r=r.apply(n,e||[])).next())})};class Jr{constructor(e,{headers:t={},customFetch:r,region:s=Xe.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Nr(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return zr(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let h;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",h=a):typeof a=="string"?(o["Content-Type"]="text/plain",h=a):typeof FormData<"u"&&a instanceof FormData?h=a:(o["Content-Type"]="application/json",h=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:h}).catch(g=>{throw new Br(g)}),u=c.headers.get("x-relay-error");if(u&&u==="true")throw new Hr(c);if(!c.ok)throw new Fr(c);let f=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),d;return f==="application/json"?d=yield c.json():f==="application/octet-stream"?d=yield c.blob():f==="text/event-stream"?d=c:f==="multipart/form-data"?d=yield c.formData():d=yield c.text(),{data:d,error:null}}catch(s){return{data:null,error:s}}})}}function Vr(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Kr(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var P={},se={},ie={},ne={},ae={},oe={},Gr=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ve=Gr();const Wr=ve.fetch,Yt=ve.fetch.bind(ve),er=ve.Headers,Zr=ve.Request,Qr=ve.Response,pe=Object.freeze(Object.defineProperty({__proto__:null,Headers:er,Request:Zr,Response:Qr,default:Yt,fetch:Wr},Symbol.toStringTag,{value:"Module"})),Xr=Kr(pe);var je={},wt;function tr(){if(wt)return je;wt=1,Object.defineProperty(je,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return je.default=n,je}var yt;function rr(){if(yt)return oe;yt=1;var n=oe&&oe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(oe,"__esModule",{value:!0});const e=n(Xr),t=n(tr());class r{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,a){return this.headers=Object.assign({},this.headers),this.headers[i]=a,this}then(i,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var c,u,f;let d=null,g=null,v=null,p=h.status,b=h.statusText;if(h.ok){if(this.method!=="HEAD"){const C=await h.text();C===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?g=C:g=JSON.parse(C))}const k=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),y=(u=h.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");k&&y&&y.length>1&&(v=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(d={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,v=null,p=406,b="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const k=await h.text();try{d=JSON.parse(k),Array.isArray(d)&&h.status===404&&(g=[],d=null,p=200,b="OK")}catch{h.status===404&&k===""?(p=204,b="No Content"):d={message:k}}if(d&&this.isMaybeSingle&&(!((f=d==null?void 0:d.details)===null||f===void 0)&&f.includes("0 rows"))&&(d=null,p=200,b="OK"),d&&this.shouldThrowOnError)throw new t.default(d)}return{error:d,data:g,count:v,status:p,statusText:b}});return this.shouldThrowOnError||(l=l.catch(h=>{var c,u,f;return{error:{message:`${(c=h==null?void 0:h.name)!==null&&c!==void 0?c:"FetchError"}: ${h==null?void 0:h.message}`,details:`${(u=h==null?void 0:h.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(f=h==null?void 0:h.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,a)}}return oe.default=r,oe}var bt;function sr(){if(bt)return ae;bt=1;var n=ae&&ae.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ae,"__esModule",{value:!0});const e=n(rr());class t extends e.default{select(s){let i=!1;const a=(s??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:i=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const h=l?`${l}.order`:"order",c=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${c?`${c},`:""}${s}.${i?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:a=i}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${s}`),this}range(s,i,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,h=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(h,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:i=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:h="text"}={}){var c;const u=[s?"analyze":null,i?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${h}; for="${f}"; options=${u};`,h==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return ae.default=t,ae}var kt;function at(){if(kt)return ne;kt=1;var n=ne&&ne.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ne,"__esModule",{value:!0});const e=n(sr());class t extends e.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const a=Array.from(new Set(i)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(s,`in.(${a})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:a,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const h=a===void 0?"":`(${a})`;return this.url.searchParams.append(s,`${l}fts${h}.${i}`),this}match(s){return Object.entries(s).forEach(([i,a])=>{this.url.searchParams.append(i,`eq.${a}`)}),this}not(s,i,a){return this.url.searchParams.append(s,`not.${i}.${a}`),this}or(s,{foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.or`:"or";return this.url.searchParams.append(o,`(${s})`),this}filter(s,i,a){return this.url.searchParams.append(s,`${i}.${a}`),this}}return ne.default=t,ne}var Ct;function ir(){if(Ct)return ie;Ct=1;var n=ie&&ie.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ie,"__esModule",{value:!0});const e=n(at());class t{constructor(s,{headers:i={},schema:a,fetch:o}){this.url=s,this.headers=i,this.schema=a,this.fetch=o}select(s,{head:i=!1,count:a}={}){const o=i?"HEAD":"GET";let l=!1;const h=(s??"*").split("").map(c=>/\s/.test(c)&&!l?"":(c==='"'&&(l=!l),c)).join("");return this.url.searchParams.set("select",h),a&&(this.headers.Prefer=`count=${a}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:i,defaultToNull:a=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(s)){const h=s.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(h.length>0){const c=[...new Set(h)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:i,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){const h="POST",c=[`resolution=${a?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&c.push(this.headers.Prefer),o&&c.push(`count=${o}`),l||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(s)){const u=s.reduce((f,d)=>f.concat(Object.keys(d)),[]);if(u.length>0){const f=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:i}={}){const a="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),this.headers.Prefer=o.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const i="DELETE",a=[];return s&&a.push(`count=${s}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return ie.default=t,ie}var _e={},me={},St;function Yr(){return St||(St=1,Object.defineProperty(me,"__esModule",{value:!0}),me.version=void 0,me.version="0.0.0-automated"),me}var Et;function es(){if(Et)return _e;Et=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.DEFAULT_HEADERS=void 0;const n=Yr();return _e.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},_e}var Tt;function ts(){if(Tt)return se;Tt=1;var n=se&&se.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(se,"__esModule",{value:!0});const e=n(ir()),t=n(at()),r=es();class s{constructor(a,{headers:o={},schema:l,fetch:h}={}){this.url=a,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=h}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new s(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:h=!1,count:c}={}){let u;const f=new URL(`${this.url}/rpc/${a}`);let d;l||h?(u=l?"HEAD":"GET",Object.entries(o).filter(([v,p])=>p!==void 0).map(([v,p])=>[v,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([v,p])=>{f.searchParams.append(v,p)})):(u="POST",d=o);const g=Object.assign({},this.headers);return c&&(g.Prefer=`count=${c}`),new t.default({method:u,url:f,headers:g,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}}return se.default=s,se}var Ot;function rs(){if(Ot)return P;Ot=1;var n=P&&P.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(P,"__esModule",{value:!0}),P.PostgrestError=P.PostgrestBuilder=P.PostgrestTransformBuilder=P.PostgrestFilterBuilder=P.PostgrestQueryBuilder=P.PostgrestClient=void 0;const e=n(ts());P.PostgrestClient=e.default;const t=n(ir());P.PostgrestQueryBuilder=t.default;const r=n(at());P.PostgrestFilterBuilder=r.default;const s=n(sr());P.PostgrestTransformBuilder=s.default;const i=n(rr());P.PostgrestBuilder=i.default;const a=n(tr());return P.PostgrestError=a.default,P.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:i.default,PostgrestError:a.default},P}var ss=rs();const is=Vr(ss),{PostgrestClient:ns,PostgrestQueryBuilder:un,PostgrestFilterBuilder:dn,PostgrestTransformBuilder:fn,PostgrestBuilder:gn,PostgrestError:vn}=is,as="2.11.2",os={"X-Client-Info":`realtime-js/${as}`},ls="1.0.0",nr=1e4,cs=1e3;var de;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(de||(de={}));var x;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(x||(x={}));var D;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(D||(D={}));var Ye;(function(n){n.websocket="websocket"})(Ye||(Ye={}));var G;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(G||(G={}));class hs{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+s));a=a+s;const l=r.decode(e.slice(a,a+i));a=a+i;const h=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:h}}}class ar{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var S;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(S||(S={}));const At=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,a)=>(i[a]=us(a,n,e,s),i),{})},us=(n,e,t,r)=>{const s=e.find(o=>o.name===n),i=s==null?void 0:s.type,a=t[n];return i&&!r.includes(i)?or(i,a):et(a)},or=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return vs(e,t)}switch(n){case S.bool:return ds(e);case S.float4:case S.float8:case S.int2:case S.int4:case S.int8:case S.numeric:case S.oid:return fs(e);case S.json:case S.jsonb:return gs(e);case S.timestamp:return ps(e);case S.abstime:case S.date:case S.daterange:case S.int4range:case S.int8range:case S.money:case S.reltime:case S.text:case S.time:case S.timestamptz:case S.timetz:case S.tsrange:case S.tstzrange:return et(e);default:return et(e)}},et=n=>n,ds=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},fs=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},gs=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},vs=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const a=n.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>or(e,o))}return n},ps=n=>typeof n=="string"?n.replace(" ","T"):n,lr=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Ve{constructor(e,t,r={},s=nr){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Pt;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Pt||(Pt={}));class ke{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ke.syncState(this.state,s,i,a),this.pendingDiffs.forEach(l=>{this.state=ke.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ke.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(h,c)=>{a[h]||(l[h]=c)}),this.map(a,(h,c)=>{const u=i[h];if(u){const f=c.map(p=>p.presence_ref),d=u.map(p=>p.presence_ref),g=c.filter(p=>d.indexOf(p.presence_ref)<0),v=u.filter(p=>f.indexOf(p.presence_ref)<0);g.length>0&&(o[h]=g),v.length>0&&(l[h]=v)}else o[h]=c}),this.syncDiff(i,{joins:o,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(o,l)=>{var h;const c=(h=e[o])!==null&&h!==void 0?h:[];if(e[o]=this.cloneDeep(l),c.length>0){const u=e[o].map(d=>d.presence_ref),f=c.filter(d=>u.indexOf(d.presence_ref)<0);e[o].unshift(...f)}r(o,c,l)}),this.map(a,(o,l)=>{let h=e[o];if(!h)return;const c=l.map(u=>u.presence_ref);h=h.filter(u=>c.indexOf(u.presence_ref)<0),e[o]=h,s(o,h,l),h.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lt;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Lt||(Lt={}));var jt;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(jt||(jt={}));var N;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(N||(N={}));class ot{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=x.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ve(this,D.join,this.params,this.timeout),this.rejoinTimer=new ar(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=x.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=x.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=x.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=x.errored,this.rejoinTimer.scheduleTimeout())}),this._on(D.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new ke(this),this.broadcastEndpointURL=lr(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(c=>e==null?void 0:e(N.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(N.CLOSED));const l={},h={broadcast:i,presence:a,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:h},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var u;if(this.socket.setAuth(),c===void 0){e==null||e(N.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,d=(u=f==null?void 0:f.length)!==null&&u!==void 0?u:0,g=[];for(let v=0;v<d;v++){const p=f[v],{filter:{event:b,schema:_,table:k,filter:y}}=p,C=c&&c[v];if(C&&C.event===b&&C.schema===_&&C.table===k&&C.filter===y)g.push(Object.assign(Object.assign({},p),{id:C.id}));else{this.unsubscribe(),e==null||e(N.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(N.SUBSCRIBED);return}}).receive("error",c=>{e==null||e(N.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(N.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=h.body)===null||s===void 0?void 0:s.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const h=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),h.receive("ok",()=>i("ok")),h.receive("error",()=>i("error")),h.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=x.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(D.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new Ve(this,D.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Ve(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:h,join:c}=D;if(r&&[o,l,h,c].indexOf(a)>=0&&r!==this._joinRef())return;let f=this._onMessage(a,t,r);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(d=>{var g,v,p;return((g=d.filter)===null||g===void 0?void 0:g.event)==="*"||((p=(v=d.filter)===null||v===void 0?void 0:v.event)===null||p===void 0?void 0:p.toLocaleLowerCase())===a}).map(d=>d.callback(f,r)):(i=this.bindings[a])===null||i===void 0||i.filter(d=>{var g,v,p,b,_,k;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in d){const y=d.id,C=(g=d.filter)===null||g===void 0?void 0:g.event;return y&&((v=t.ids)===null||v===void 0?void 0:v.includes(y))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((p=t.data)===null||p===void 0?void 0:p.type.toLocaleLowerCase()))}else{const y=(_=(b=d==null?void 0:d.filter)===null||b===void 0?void 0:b.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return y==="*"||y===((k=t==null?void 0:t.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===a}).map(d=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:v,table:p,commit_timestamp:b,type:_,errors:k}=g;f=Object.assign(Object.assign({},{schema:v,table:p,commit_timestamp:b,eventType:_,new:{},old:{},errors:k}),this._getPayloadRecords(g))}d.callback(f,r)})}_isClosed(){return this.state===x.closed}_isJoined(){return this.state===x.joined}_isJoining(){return this.state===x.joining}_isLeaving(){return this.state===x.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&ot.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(D.close,{},e)}_onError(e){this._on(D.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=x.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=At(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=At(e.columns,e.old_record)),t}}const _s=()=>{},ms=typeof WebSocket<"u",ws=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ys{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=os,this.params={},this.timeout=nr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=_s,this.conn=null,this.sendBuffer=[],this.serializer=new hs,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>ge(async()=>{const{default:l}=await Promise.resolve().then(()=>pe);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${Ye.websocket}`,this.httpEndpoint=lr(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ar(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(ms){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new bs(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ge(async()=>{const{default:e}=await import("./browser.Bm7ODA-q.js").then(t=>t.b);return{default:e}},[],import.meta.url).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ls}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case de.connecting:return G.Connecting;case de.open:return G.Open;case de.closing:return G.Closing;default:return G.Closed}}isConnected(){return this.connectionState()===G.Open}channel(e,t={config:{}}){const r=new ot(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:s,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(s=>{t&&s.updateJoinPayload({access_token:t}),s.joinedOnce&&s._isJoined()&&s._push(D.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(cs,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(r)).forEach(o=>o._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(D.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([ws],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class bs{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=de.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class lt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function L(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class ks extends lt{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class tt extends lt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Cs=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{h(r.next(c))}catch(u){a(u)}}function l(c){try{h(r.throw(c))}catch(u){a(u)}}function h(c){c.done?i(c.value):s(c.value).then(o,l)}h((r=r.apply(n,e||[])).next())})};const cr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ge(async()=>{const{default:r}=await Promise.resolve().then(()=>pe);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Ss=()=>Cs(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ge(()=>Promise.resolve().then(()=>pe),void 0,import.meta.url)).Response:Response}),rt=n=>{if(Array.isArray(n))return n.map(t=>rt(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=rt(r)}),e};var Z=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{h(r.next(c))}catch(u){a(u)}}function l(c){try{h(r.throw(c))}catch(u){a(u)}}function h(c){c.done?i(c.value):s(c.value).then(o,l)}h((r=r.apply(n,e||[])).next())})};const Ke=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Es=(n,e,t)=>Z(void 0,void 0,void 0,function*(){const r=yield Ss();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{e(new ks(Ke(s),n.status||500))}).catch(s=>{e(new tt(Ke(s),s))}):e(new tt(Ke(n),n))}),Ts=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),t))};function Te(n,e,t,r,s,i){return Z(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,Ts(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Es(l,o,r))})})}function De(n,e,t,r){return Z(this,void 0,void 0,function*(){return Te(n,"GET",e,t,r)})}function F(n,e,t,r,s){return Z(this,void 0,void 0,function*(){return Te(n,"POST",e,r,s,t)})}function Os(n,e,t,r,s){return Z(this,void 0,void 0,function*(){return Te(n,"PUT",e,r,s,t)})}function As(n,e,t,r){return Z(this,void 0,void 0,function*(){return Te(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function hr(n,e,t,r,s){return Z(this,void 0,void 0,function*(){return Te(n,"DELETE",e,r,s,t)})}var j=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{h(r.next(c))}catch(u){a(u)}}function l(c){try{h(r.throw(c))}catch(u){a(u)}}function h(c){c.done?i(c.value):s(c.value).then(o,l)}h((r=r.apply(n,e||[])).next())})};const Ps={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$t={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ls{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=cr(s)}uploadOrUpdate(e,t,r,s){return j(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},$t),s);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const h=this._removeEmptyFolders(t),c=this._getFinalPath(h),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),f=yield u.json();return u.ok?{data:{path:h,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(L(i))return{data:null,error:i};throw i}})}upload(e,t,r){return j(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return j(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const h=Object.assign({upsert:$t.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",h.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",h.cacheControl)):(l=r,c["cache-control"]=`max-age=${h.cacheControl}`,c["content-type"]=h.contentType);const u=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:c}),f=yield u.json();return u.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(L(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return j(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield F(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new lt("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}update(e,t,r){return j(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return j(this,void 0,void 0,function*(){try{return{data:yield F(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}copy(e,t,r){return j(this,void 0,void 0,function*(){try{return{data:{path:(yield F(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return j(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield F(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return j(this,void 0,void 0,function*(){try{const s=yield F(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}download(e,t){return j(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield De(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(L(o))return{data:null,error:o};throw o}})}info(e){return j(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield De(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:rt(r),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}exists(e){return j(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield As(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(L(r)&&r instanceof tt){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let h=s.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${h}`)}}}remove(e){return j(this,void 0,void 0,function*(){try{return{data:yield hr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(L(t))return{data:null,error:t};throw t}})}list(e,t,r){return j(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Ps),t),{prefix:e||""});return{data:yield F(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const js="2.7.1",$s={"X-Client-Info":`storage-js/${js}`};var le=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{h(r.next(c))}catch(u){a(u)}}function l(c){try{h(r.throw(c))}catch(u){a(u)}}function h(c){c.done?i(c.value):s(c.value).then(o,l)}h((r=r.apply(n,e||[])).next())})};class Rs{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},$s),t),this.fetch=cr(r)}listBuckets(){return le(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(L(e))return{data:null,error:e};throw e}})}getBucket(e){return le(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(L(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return le(this,void 0,void 0,function*(){try{return{data:yield F(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return le(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}})}emptyBucket(e){return le(this,void 0,void 0,function*(){try{return{data:yield F(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(L(t))return{data:null,error:t};throw t}})}deleteBucket(e){return le(this,void 0,void 0,function*(){try{return{data:yield hr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(L(t))return{data:null,error:t};throw t}})}}class xs extends Rs{constructor(e,t={},r){super(e,t,r)}from(e){return new Ls(this.url,this.headers,e,this.fetch)}}const Is="2.47.8";let ye="";typeof Deno<"u"?ye="deno":typeof document<"u"?ye="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ye="react-native":ye="node";const Us={"X-Client-Info":`supabase-js-${ye}/${Is}`},Ds={headers:Us},qs={schema:"public"},Ms={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ns={};var Bs=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{h(r.next(c))}catch(u){a(u)}}function l(c){try{h(r.throw(c))}catch(u){a(u)}}function h(c){c.done?i(c.value):s(c.value).then(o,l)}h((r=r.apply(n,e||[])).next())})};const Hs=n=>{let e;return n?e=n:typeof fetch>"u"?e=Yt:e=fetch,(...t)=>e(...t)},Fs=()=>typeof Headers>"u"?er:Headers,zs=(n,e,t)=>{const r=Hs(t),s=Fs();return(i,a)=>Bs(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let h=new s(a==null?void 0:a.headers);return h.has("apikey")||h.set("apikey",n),h.has("Authorization")||h.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},a),{headers:h}))})};var Js=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{h(r.next(c))}catch(u){a(u)}}function l(c){try{h(r.throw(c))}catch(u){a(u)}}function h(c){c.done?i(c.value):s(c.value).then(o,l)}h((r=r.apply(n,e||[])).next())})};function Vs(n){return n.replace(/\/$/,"")}function Ks(n,e){const{db:t,auth:r,realtime:s,global:i}=n,{db:a,auth:o,realtime:l,global:h}=e,c={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},h),i),accessToken:()=>Js(this,void 0,void 0,function*(){return""})};return n.accessToken?c.accessToken=n.accessToken:delete c.accessToken,c}const ur="2.67.1",Gs="http://localhost:9999",Ws="supabase.auth.token",Zs={"X-Client-Info":`gotrue-js/${ur}`},Rt=10,st="X-Supabase-Api-Version",dr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Qs(n){return Math.round(Date.now()/1e3)+n}function Xs(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const U=()=>typeof document<"u",V={tested:!1,writable:!1},Ce=()=>{if(!U())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(V.tested)return V.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),V.tested=!0,V.writable=!0}catch{V.tested=!0,V.writable=!1}return V.writable};function Ge(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const fr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ge(async()=>{const{default:r}=await Promise.resolve().then(()=>pe);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Ys=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",gr=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},$e=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Re=async(n,e)=>{await n.removeItem(e)};function ei(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,s,i,a,o,l,h,c=0;for(n=n.replace("-","+").replace("_","/");c<n.length;)a=e.indexOf(n.charAt(c++)),o=e.indexOf(n.charAt(c++)),l=e.indexOf(n.charAt(c++)),h=e.indexOf(n.charAt(c++)),r=a<<2|o>>4,s=(o&15)<<4|l>>2,i=(l&3)<<6|h,t=t+String.fromCharCode(r),l!=64&&s!=0&&(t=t+String.fromCharCode(s)),h!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class Be{constructor(){this.promise=new Be.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Be.promiseConstructor=Promise;function xt(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(ei(r))}async function ti(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function ri(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await n(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function si(n){return("0"+n.toString(16)).substr(-2)}function ii(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,si).join("")}async function ni(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}function ai(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function oi(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await ni(n);return ai(t)}async function ce(n,e,t=!1){const r=ii();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await gr(n,`${e}-code-verifier`,s);const i=await oi(r);return[i,r===i?"plain":"s256"]}const li=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ci(n){const e=n.headers.get(st);if(!e||!e.match(li))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class ct extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function m(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class hi extends ct{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function ui(n){return m(n)&&n.name==="AuthApiError"}class vr extends ct{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Q extends ct{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class B extends Q{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function di(n){return m(n)&&n.name==="AuthSessionMissingError"}class We extends Q{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xe extends Q{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ie extends Q{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fi(n){return m(n)&&n.name==="AuthImplicitGrantRedirectError"}class It extends Q{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class it extends Q{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ze(n){return m(n)&&n.name==="AuthRetryableFetchError"}class Ut extends Q{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var gi=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const K=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),vi=[502,503,504];async function Dt(n){var e;if(!Ys(n))throw new it(K(n),0);if(vi.includes(n.status))throw new it(K(n),n.status);let t;try{t=await n.json()}catch(i){throw new vr(K(i),i)}let r;const s=ci(n);if(s&&s.getTime()>=dr["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Ut(K(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new B}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Ut(K(t),n.status,t.weak_password.reasons);throw new hi(K(t),n.status||500,r)}const pi=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function w(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[st]||(i[st]=dr["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await _i(n,e,t+o,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function _i(n,e,t,r,s,i){const a=pi(e,r,s,i);let o;try{o=await n(t,Object.assign({},a))}catch(l){throw console.error(l),new it(K(l),0)}if(o.ok||await Dt(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await Dt(l)}}function H(n){var e;let t=null;bi(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Qs(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function qt(n){const e=H(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function z(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function mi(n){return{data:n,error:null}}function wi(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,a=gi(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function yi(n){return n}function bi(n){return n.access_token&&n.refresh_token&&n.expires_in}var ki=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Ci{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=fr(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await w(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(m(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await w(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:z})}catch(r){if(m(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=ki(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await w(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:wi,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(m(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await w(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:z})}catch(t){if(m(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,a,o,l;try{const h={nextPage:null,lastPage:0,total:0},c=await w(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:yi});if(c.error)throw c.error;const u=await c.json(),f=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(g=>{const v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(g.split(";")[1].split("=")[1]);h[`${p}Page`]=v}),h.total=parseInt(f)),{data:Object.assign(Object.assign({},u),h),error:null}}catch(h){if(m(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){try{return await w(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:z})}catch(t){if(m(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await w(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:z})}catch(r){if(m(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await w(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:z})}catch(r){if(m(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await w(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(m(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await w(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(m(t))return{data:null,error:t};throw t}}}const Si={getItem:n=>Ce()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Ce()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Ce()&&globalThis.localStorage.removeItem(n)}};function Mt(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Ei(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const he={debug:!!(globalThis&&Ce()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class pr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ti extends pr{}async function Oi(n,e,t){he.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),he.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){he.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{he.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw he.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Ti(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(he.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Ei();const Ai={url:Gs,storageKey:Ws,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Zs,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},we=30*1e3,Nt=3;async function Bt(n,e,t){return await t()}class Ee{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ee.nextInstanceID,Ee.nextInstanceID+=1,this.instanceID>0&&U()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Ai),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Ci({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=fr(s.fetch),this.lock=s.lock||Bt,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:U()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Oi:this.lock=Bt,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Ce()?this.storage=Si:(this.memoryStorage={},this.storage=Mt(this.memoryStorage)):(this.memoryStorage={},this.storage=Mt(this.memoryStorage)),U()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ur}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=U()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",t),t||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:r,error:s}=await this._getSessionFromURL(t);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),fi(s)){const o=(e=s.details)===null||e===void 0?void 0:e.code;if(o==="identity_already_exists"||o==="identity_not_found"||o==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return m(t)?{error:t}:{error:new vr("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await w(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:H}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,h=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(i){if(m(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:c,password:u,options:f}=e;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await ce(this.storage,this.storageKey)),i=await w(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:c,password:u,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:d,code_challenge_method:g},xform:H})}else if("phone"in e){const{phone:c,password:u,options:f}=e;i=await w(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:u,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:H})}else throw new xe("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,h=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(i){if(m(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await w(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:qt})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await w(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:qt})}else throw new xe("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new We}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(m(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await $e(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:i,error:a}=await w(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:H});if(await Re(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new We}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(m(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:a}=e,o=await w(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:H}),{data:l,error:h}=o;return h?{data:{user:null,session:null},error:h}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new We}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:h})}catch(t){if(m(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,a;try{if("email"in e){const{email:o,options:l}=e;let h=null,c=null;this.flowType==="pkce"&&([h,c]=await ce(this.storage,this.storageKey));const{error:u}=await w(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:h,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in e){const{phone:o,options:l}=e,{data:h,error:c}=await w(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:c}}throw new xe("You must provide either an email or phone number.")}catch(o){if(m(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await w(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:H});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,h=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(s){if(m(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await ce(this.storage,this.storageKey)),await w(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:mi})}catch(i){if(m(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new B;const{error:s}=await w(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(m(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:a}=await w(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:a,error:o}=await w(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new xe("You must provide either an email or phone number and a type")}catch(t){if(m(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await $e(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,h,c)=>(!a&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,h,c))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await w(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:z}):await this._useSession(async t=>{var r,s,i;const{data:a,error:o}=t;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new B}:await w(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:z})})}catch(t){if(m(t))return di(t)&&(await this._removeSession(),await Re(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new B;const a=s.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await ce(this.storage,this.storageKey));const{data:h,error:c}=await w(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:z});if(c)throw c;return a.user=h.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(m(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return xt(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new B;const t=Date.now()/1e3;let r=t,s=!0,i=null;const a=xt(e.access_token);if(a.exp&&(r=a.exp,s=r<=t),s){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(m(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new B;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(m(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!U())throw new Ie("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Ie("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new It("Not a valid PKCE flow url.");const t=Ge(window.location.href);if(e){if(!t.code)throw new It("No code detected.");const{data:_,error:k}=await this._exchangeCodeForSession(t.code);if(k)throw k;const y=new URL(window.location.href);return y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",y.toString()),{data:{session:_.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new Ie(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:h}=t;if(!i||!o||!a||!h)throw new Ie("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(o);let f=c+u;l&&(f=parseInt(l));const d=f-c;d*1e3<=we&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${u}s`);const g=f-u;c-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,c):c-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,c);const{data:v,error:p}=await this._getUser(i);if(p)throw p;const b={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:u,expires_at:f,refresh_token:a,token_type:h,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:t.type},error:null}}catch(t){if(m(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=Ge(window.location.href);return!!(U()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Ge(window.location.href),t=await $e(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const a=(r=s.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(ui(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Re(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Xs(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:a}=t;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await ce(this.storage,this.storageKey,!0));try{return await w(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(m(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(m(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var a,o,l,h,c;const{data:u,error:f}=i;if(f)throw f;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await w(this.fetch,"GET",d,{headers:this.headers,jwt:(c=(h=u.session)===null||h===void 0?void 0:h.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return U()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(m(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)throw a;return await w(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(m(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await ri(async s=>(s>0&&await ti(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await w(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:H})),(s,i)=>{const a=200*Math.pow(2,s);return i&&Ze(i)&&Date.now()+a-r<we})}catch(r){if(this._debug(t,"error",r),m(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),U()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await $e(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<s+Rt;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${Rt}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),Ze(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new B;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Be;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new B;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),m(i)){const a={session:null,error:i};return Ze(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await gr(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Re(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&U()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),we);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/we);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${we}ms, refresh threshold is ${Nt} ticks`),s<=Nt&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof pr)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!U()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await ce(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await w(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(m(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:h}=await w(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return h?{data:null,error:h}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(m(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await w(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(m(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await w(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(m(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(s.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}}Ee.nextInstanceID=0;const Pi=Ee;class Li extends Pi{constructor(e){super(e)}}var ji=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{h(r.next(c))}catch(u){a(u)}}function l(c){try{h(r.throw(c))}catch(u){a(u)}}function h(c){c.done?i(c.value):s(c.value).then(o,l)}h((r=r.apply(n,e||[])).next())})};class $i{constructor(e,t,r){var s,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=Vs(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,h={db:qs,realtime:Ns,auth:Object.assign(Object.assign({},Ms),{storageKey:l}),global:Ds},c=Ks(r??{},h);this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=c.global.headers)!==null&&i!==void 0?i:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=c.auth)!==null&&a!==void 0?a:{},this.headers,c.global.fetch),this.fetch=zs(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new ns(`${o}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new Jr(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new xs(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ji(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:a,lock:o,debug:l},h,c){var u;const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Li({url:this.authUrl,headers:Object.assign(Object.assign({},f),h),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:a,lock:o,debug:l,fetch:c,hasCustomAuthorizationHeader:(u="Authorization"in this.headers)!==null&&u!==void 0?u:!1})}_initRealtimeClient(e){return new ys(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const _r=(n,e,t)=>new $i(n,e,t),mr="0.5.2";var Ue={};/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var Ht;function Ri(){if(Ht)return Ue;Ht=1,Ue.parse=a,Ue.serialize=h;var n=Object.prototype.toString,e=Object.prototype.hasOwnProperty,t=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,r=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,s=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/;function a(d,g){if(typeof d!="string")throw new TypeError("argument str must be a string");var v={},p=d.length;if(p<2)return v;var b=g&&g.decode||c,_=0,k=0,y=0;do{if(k=d.indexOf("=",_),k===-1)break;if(y=d.indexOf(";",_),y===-1)y=p;else if(k>y){_=d.lastIndexOf(";",k-1)+1;continue}var C=o(d,_,k),X=l(d,k,C),J=d.slice(C,X);if(!e.call(v,J)){var M=o(d,k+1,y),Y=l(d,y,M);d.charCodeAt(M)===34&&d.charCodeAt(Y-1)===34&&(M++,Y--);var ee=d.slice(M,Y);v[J]=f(ee,b)}_=y+1}while(_<p);return v}function o(d,g,v){do{var p=d.charCodeAt(g);if(p!==32&&p!==9)return g}while(++g<v);return v}function l(d,g,v){for(;g>v;){var p=d.charCodeAt(--g);if(p!==32&&p!==9)return g+1}return v}function h(d,g,v){var p=v&&v.encode||encodeURIComponent;if(typeof p!="function")throw new TypeError("option encode is invalid");if(!t.test(d))throw new TypeError("argument name is invalid");var b=p(g);if(!r.test(b))throw new TypeError("argument val is invalid");var _=d+"="+b;if(!v)return _;if(v.maxAge!=null){var k=Math.floor(v.maxAge);if(!isFinite(k))throw new TypeError("option maxAge is invalid");_+="; Max-Age="+k}if(v.domain){if(!s.test(v.domain))throw new TypeError("option domain is invalid");_+="; Domain="+v.domain}if(v.path){if(!i.test(v.path))throw new TypeError("option path is invalid");_+="; Path="+v.path}if(v.expires){var y=v.expires;if(!u(y)||isNaN(y.valueOf()))throw new TypeError("option expires is invalid");_+="; Expires="+y.toUTCString()}if(v.httpOnly&&(_+="; HttpOnly"),v.secure&&(_+="; Secure"),v.partitioned&&(_+="; Partitioned"),v.priority){var C=typeof v.priority=="string"?v.priority.toLowerCase():v.priority;switch(C){case"low":_+="; Priority=Low";break;case"medium":_+="; Priority=Medium";break;case"high":_+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(v.sameSite){var X=typeof v.sameSite=="string"?v.sameSite.toLowerCase():v.sameSite;switch(X){case!0:_+="; SameSite=Strict";break;case"lax":_+="; SameSite=Lax";break;case"strict":_+="; SameSite=Strict";break;case"none":_+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return _}function c(d){return d.indexOf("%")!==-1?decodeURIComponent(d):d}function u(d){return n.call(d)==="[object Date]"}function f(d,g){try{return g(d)}catch{return d}}return Ue}var Ft=Ri();function fe(){return typeof window<"u"&&typeof window.document<"u"}const W={path:"/",sameSite:"lax",httpOnly:!1,maxAge:400*24*60*60},xi=3180,Ii=/^(.*)[.](0|[1-9][0-9]*)$/;function qe(n,e){if(n===e)return!0;const t=n.match(Ii);return!!(t&&t[1]===e)}function wr(n,e,t){const r=xi;let s=encodeURIComponent(e);if(s.length<=r)return[{name:n,value:e}];const i=[];for(;s.length>0;){let a=s.slice(0,r);const o=a.lastIndexOf("%");o>r-3&&(a=a.slice(0,o));let l="";for(;a.length>0;)try{l=decodeURIComponent(a);break}catch(h){if(h instanceof URIError&&a.at(-3)==="%"&&a.length>3)a=a.slice(0,a.length-3);else throw h}i.push(l),s=s.slice(a.length)}return i.map((a,o)=>({name:`${n}.${o}`,value:a}))}async function zt(n,e){const t=await e(n);if(t)return t;let r=[];for(let s=0;;s++){const i=`${n}.${s}`,a=await e(i);if(!a)break;r.push(a)}return r.length>0?r.join(""):null}const Me="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Jt=` 	
\r=`.split(""),Ui=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Jt.length;e+=1)n[Jt[e].charCodeAt(0)]=-2;for(let e=0;e<Me.length;e+=1)n[Me[e].charCodeAt(0)]=e;return n})();function yr(n){const e=[];let t=0,r=0;if(qi(n,i=>{for(t=t<<8|i,r+=8;r>=6;){const a=t>>r-6&63;e.push(Me[a]),r-=6}}),r>0)for(t=t<<6-r,r=6;r>=6;){const i=t>>r-6&63;e.push(Me[i]),r-=6}return e.join("")}function Vt(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0};let s=0,i=0;for(let a=0;a<n.length;a+=1){const o=n.charCodeAt(a),l=Ui[o];if(l>-1)for(s=s<<6|l,i+=6;i>=8;)Mi(s>>i-8&255,r,t),i-=8;else{if(l===-2)continue;throw new Error(`Invalid Base64-URL character "${n.at(a)}" at position ${a}`)}}return e.join("")}function Di(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function qi(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}Di(r,e)}}function Mi(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}const ue="base64-";function br(n,e){const t=n.cookies??null,r=n.cookieEncoding,s={},i={};let a,o;if(t)if("get"in t){const l=async h=>{const c=h.flatMap(f=>[f,...Array.from({length:5}).map((d,g)=>`${f}.${g}`)]),u=[];for(let f=0;f<c.length;f+=1){const d=await t.get(c[f]);!d&&typeof d!="string"||u.push({name:c[f],value:d})}return u};if(a=async h=>await l(h),"set"in t&&"remove"in t)o=async h=>{for(let c=0;c<h.length;c+=1){const{name:u,value:f,options:d}=h[c];f?await t.set(u,f,d):await t.remove(u,d)}};else if(e)o=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw new Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in t)if(a=async()=>await t.getAll(),"setAll"in t)o=t.setAll;else if(e)o=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw new Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw new Error(`@supabase/ssr: ${e?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).${fe()?" As this is called in a browser runtime, consider removing the cookies option object to use the document.cookie API automatically.":""}`);else if(!e&&fe()){const l=()=>{const h=Ft.parse(document.cookie);return Object.keys(h).map(c=>({name:c,value:h[c]}))};a=()=>l(),o=h=>{h.forEach(({name:c,value:u,options:f})=>{document.cookie=Ft.serialize(c,u,f)})}}else{if(e)throw new Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");a=()=>[],o=()=>{throw new Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")}}return e?{getAll:a,setAll:o,setItems:s,removedItems:i,storage:{isServer:!0,getItem:async l=>{if(typeof s[l]=="string")return s[l];if(i[l])return null;const h=await a([l]),c=await zt(l,async f=>{const d=(h==null?void 0:h.find(({name:g})=>g===f))||null;return d?d.value:null});if(!c)return null;let u=c;return typeof c=="string"&&c.startsWith(ue)&&(u=Vt(c.substring(ue.length))),u},setItem:async(l,h)=>{l.endsWith("-code-verifier")&&await kr({getAll:a,setAll:o,setItems:{[l]:h},removedItems:{}},{cookieOptions:(n==null?void 0:n.cookieOptions)??null,cookieEncoding:r}),s[l]=h,delete i[l]},removeItem:async l=>{delete s[l],i[l]=!0}}}:{getAll:a,setAll:o,setItems:s,removedItems:i,storage:{isServer:!1,getItem:async l=>{const h=await a([l]),c=await zt(l,async f=>{const d=(h==null?void 0:h.find(({name:g})=>g===f))||null;return d?d.value:null});if(!c)return null;let u=c;return c.startsWith(ue)&&(u=Vt(c.substring(ue.length))),u},setItem:async(l,h)=>{const c=await a([l]),u=(c==null?void 0:c.map(({name:_})=>_))||[],f=new Set(u.filter(_=>qe(_,l)));let d=h;r==="base64url"&&(d=ue+yr(h));const g=wr(l,d);g.forEach(({name:_})=>{f.delete(_)});const v={...W,...n==null?void 0:n.cookieOptions,maxAge:0},p={...W,...n==null?void 0:n.cookieOptions,maxAge:W.maxAge};delete v.name,delete p.name;const b=[...[...f].map(_=>({name:_,value:"",options:v})),...g.map(({name:_,value:k})=>({name:_,value:k,options:p}))];b.length>0&&await o(b)},removeItem:async l=>{const h=await a([l]),u=((h==null?void 0:h.map(({name:d})=>d))||[]).filter(d=>qe(d,l)),f={...W,...n==null?void 0:n.cookieOptions,maxAge:0};delete f.name,u.length>0&&await o(u.map(d=>({name:d,value:"",options:f})))}}}}async function kr({getAll:n,setAll:e,setItems:t,removedItems:r},s){const i=s.cookieEncoding,a=s.cookieOptions??null,o=await n([...t?Object.keys(t):[],...r?Object.keys(r):[]]),l=(o==null?void 0:o.map(({name:d})=>d))||[],h=Object.keys(r).flatMap(d=>l.filter(g=>qe(g,d))),c=Object.keys(t).flatMap(d=>{const g=new Set(l.filter(b=>qe(b,d)));let v=t[d];i==="base64url"&&(v=ue+yr(v));const p=wr(d,v);return p.forEach(b=>{g.delete(b.name)}),h.push(...g),p}),u={...W,...a,maxAge:0},f={...W,...a,maxAge:W.maxAge};delete u.name,delete f.name,await e([...h.map(d=>({name:d,value:"",options:u})),...c.map(({name:d,value:g})=>({name:d,value:g,options:f}))])}let Qe;function Ni(n,e,t){var a,o;const r=(t==null?void 0:t.isSingleton)===!0||(!t||!("isSingleton"in t))&&fe();if(r&&Qe)return Qe;const{storage:s}=br({...t,cookieEncoding:(t==null?void 0:t.cookieEncoding)??"base64url"},!1),i=_r(n,e,{...t,global:{...t==null?void 0:t.global,headers:{...(a=t==null?void 0:t.global)==null?void 0:a.headers,"X-Client-Info":`supabase-ssr/${mr}`}},auth:{...t==null?void 0:t.auth,...(o=t==null?void 0:t.cookieOptions)!=null&&o.name?{storageKey:t.cookieOptions.name}:null,flowType:"pkce",autoRefreshToken:fe(),detectSessionInUrl:fe(),persistSession:!0,storage:s}});return r&&(Qe=i),i}function Bi(n,e,t){var h,c;const{storage:r,getAll:s,setAll:i,setItems:a,removedItems:o}=br({...t,cookieEncoding:(t==null?void 0:t.cookieEncoding)??"base64url"},!0),l=_r(n,e,{...t,global:{...t==null?void 0:t.global,headers:{...(h=t==null?void 0:t.global)==null?void 0:h.headers,"X-Client-Info":`supabase-ssr/${mr}`}},auth:{...(c=t==null?void 0:t.cookieOptions)!=null&&c.name?{storageKey:t.cookieOptions.name}:null,...t==null?void 0:t.auth,flowType:"pkce",autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!0,storage:r}});return l.auth.onAuthStateChange(async u=>{(Object.keys(a).length>0||Object.keys(o).length>0)&&(u==="SIGNED_IN"||u==="TOKEN_REFRESHED"||u==="USER_UPDATED"||u==="PASSWORD_RECOVERY"||u==="SIGNED_OUT"||u==="MFA_CHALLENGE_VERIFIED")&&await kr({getAll:s,setAll:i,setItems:a,removedItems:o},{cookieOptions:(t==null?void 0:t.cookieOptions)??null,cookieEncoding:(t==null?void 0:t.cookieEncoding)??"base64url"})}),l}const Kt="https://fbxdhdedmnbvsnamxfrr.supabase.co",Gt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZieGRoZGVkbW5idnNuYW14ZnJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE5NzI4MDMsImV4cCI6MjA0NzU0ODgwM30.13XDQYZ6o_ykUZSiJLpnFiw0EOGKVyxlWmKwklmAKv8",Hi=async({fetch:n,data:e,depends:t})=>{t("supabase:auth");const r=fe()?Ni(Kt,Gt,{global:{fetch:n}}):Bi(Kt,Gt,{global:{fetch:n},cookies:{getAll(){return e.cookies}}}),{data:{session:s}}=await r.auth.getSession();return{supabase:r,session:s}},pn=Object.freeze(Object.defineProperty({__proto__:null,load:Hi},Symbol.toStringTag,{value:"Module"})),Fi=()=>{const n=Ur;return{page:{subscribe:n.page.subscribe},navigating:{subscribe:n.navigating.subscribe},updated:n.updated}},zi={subscribe(n){return Fi().page.subscribe(n)}};var Ji=Sr('<svg class="Logo_Svg" viewBox="0 0 358 609" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M138.938 34.9779C136.538 25.8091 143.957 14.6705 150.976 9.23117C166.944 -3.15726 192.091 -1.43749 207.919 10.0211C212.748 13.5206 218.268 20.3898 220.377 25.979C221.237 27.9988 222.337 31.2884 220.377 32.9582C218.798 34.208 214.858 33.978 212.928 33.978C209.439 33.988 199.79 34.518 197.14 32.9582C193.781 30.9784 193.431 26.549 187.912 22.6295C177.183 14.9804 167.064 22.2095 162.935 32.9782H156.935L155.936 22.9794L151.936 31.9783L150.936 26.9789L146.937 32.9782L148.937 19.9798C143.607 24.6792 143.297 28.6787 140.938 34.9779H138.938ZM98.5429 42.9969C102.602 41.2671 107.562 41.977 111.941 41.977H136.938H226.927H253.923C255.913 41.977 259.732 41.7471 261.322 42.9969C263.232 44.5067 262.992 48.7362 262.902 50.9759C262.622 57.685 259.632 56.9651 253.923 56.9751H141.937L131.939 56.0252H119.94L103.942 56.9751C101.992 56.9351 99.3028 57.0751 97.963 55.3753C96.7631 53.8555 96.8831 49.886 96.9631 47.9763C97.0731 45.2266 96.9831 45.1666 98.5429 42.9969ZM166.934 77.9725C164.705 68.6636 168.524 68.0737 176.933 67.9737C179.433 67.9437 186.512 67.5538 188.332 68.9936C190.481 70.6934 189.881 79.1223 194.631 76.8026C198.17 75.0828 195.571 67.0738 201.8 68.3437C206.409 69.2836 203.83 76.7726 207.929 76.7726C211.769 76.7726 209.849 69.9335 213.238 68.6336C219.238 66.3139 218.748 77.1726 222.717 76.3527C226.127 75.6528 223.317 66.4339 230.786 68.3037C234.776 69.3036 234.986 79.7322 232.906 82.3719C231.336 84.3516 227.227 83.9717 224.927 83.8117H164.934H141.937C132.489 84.0817 125.459 85.9114 126.109 73.973V71.1233C127.069 68.3737 129.479 67.8237 130.919 69.5935C132.729 71.7932 130.979 77.2126 134.238 78.8024C140.828 82.0219 137.168 66.054 142.437 69.1436C145.207 70.7634 144.197 78.4924 148.937 78.4924C154.826 78.4924 151.206 66.9739 156.676 68.7136C159.005 69.4635 158.935 72.9131 159.825 74.9128C161.495 78.6824 163.355 78.5624 166.934 77.9725ZM98.5429 92.9906L111.941 91.9707H136.938H226.927H254.923L261.902 93.5705L262.922 103.969L261.322 110.228L251.923 111.968L232.926 110.968H123.94H103.942L97.963 109.368L96.9431 98.9698L98.5429 92.9906ZM88.5442 119.987C92.3537 118.367 96.8431 118.967 100.943 119.007H114.941L126.939 119.967H140.938L155.936 118.967H261.922C263.962 118.967 267.691 118.727 269.341 119.987C272.721 122.567 270.931 132.865 270.921 136.965C270.921 140.155 271.771 150.003 269.321 151.943C267.731 153.193 263.912 152.963 261.922 152.963H185.932L169.934 151.963H116.941L94.9433 152.963C92.9636 152.923 90.3439 153.073 88.9641 151.363C87.2143 149.203 86.9444 139.935 86.9444 136.965C86.9344 132.126 85.7445 123.897 88.5442 119.987ZM50.9489 542.914C43.8198 542.154 37.8006 537.984 31.9513 534.085C10.4941 519.746 0.655298 499.459 0.95526 473.922L3.78489 444.926L11.7839 365.936L17.1232 308.943L21.7826 265.949L27.3819 210.956C30.6015 188.768 40.4903 170.881 57.948 156.582C63.8873 151.713 72.1862 145.834 79.9452 144.964C81.2651 156.093 77.5156 152.683 70.1365 160.982C66.207 165.391 66.497 167.471 63.6673 170.791L58.6979 175.62C55.3384 179.12 49.4791 186.689 47.3294 190.958C42.0401 201.457 40.8902 213.485 39.7803 224.954L35.1209 269.948L27.122 348.938L21.6726 403.931L15.7834 457.924C15.1634 464.104 13.5637 477.312 14.1236 482.921C15.5134 496.809 22.2526 508.218 31.9513 517.917C35.2909 521.246 38.0306 523.996 41.9501 526.696C44.1598 528.215 48.6292 530.265 49.9291 532.305C51.3489 534.535 50.9489 540.174 50.9489 542.914ZM279.52 146.094C285.029 144.824 294.608 152.243 298.917 155.633C316.965 169.851 327.094 188.458 330.333 210.956L334.083 249.951L336.743 271.948L342.082 326.941L345.742 358.937L350.081 406.931L356.73 473.922C356.95 477.122 356.28 479.772 355.98 482.921C354.21 502.029 346.171 517.327 331.823 530.165C326.904 534.565 320.975 538.464 314.915 541.114C311.956 542.414 308.576 543.763 307.196 539.764C303.437 528.935 313.256 529.405 323.824 518.827C334.303 508.358 343.362 491.13 342.402 475.922L337.083 421.929L330.743 354.937L317.825 227.953C316.705 211.955 313.746 196.227 304.137 182.959L289.999 167.921C288.649 165.411 289.369 164.392 286.659 160.962C283.239 156.642 274.751 152.373 279.52 146.094ZM90.9439 160.172H153.936L170.934 160.922H186.932L198.93 159.962H237.925H264.922C268.041 159.982 274.191 159.932 276.86 161.302C280.71 163.272 281.18 167.021 280.86 170.941C280.31 177.69 275.211 176.95 269.921 176.96H169.934L154.936 175.96H85.9445C83.7848 175.96 80.1852 176.18 78.3754 174.94C74.5859 172.331 76.0457 165.091 79.2253 162.562C81.645 160.632 87.6243 160.862 90.9439 160.172ZM291.918 214.955C291.368 208.856 289.159 203.187 285.989 197.957C284.679 195.788 280.97 191.268 280.79 189.048C280.55 185.929 285.369 181.779 289.879 184.579C294.528 187.459 299.867 197.717 301.717 202.957C302.327 205.336 303.257 208.346 301.717 210.686C300.027 213.825 295.198 214.615 291.918 214.955ZM64.9472 214.955C61.6376 214.605 56.8782 213.685 54.9784 210.566C53.7386 208.506 54.3985 206.116 54.9784 203.956C56.1983 199.217 60.7377 188.238 65.2471 186.079C67.6568 184.929 74.016 187.359 76.9456 187.959C73.1861 196.817 68.1967 198.847 64.9472 214.955ZM259.922 189.958C259.892 192.218 260.212 195.318 258.323 196.957C256.713 198.347 253.903 197.927 252.523 201.107C250.354 206.106 254.893 215.625 247.864 216.905H242.925H197.93L180.932 215.955H147.937H119.94C117.401 215.955 110.391 216.395 108.542 214.935C106.342 213.195 106.982 207.576 106.942 204.956C106.902 202.797 106.982 200.217 105.342 198.557C103.352 196.537 96.7431 196.907 98.6029 192.258C99.6528 189.618 103.632 189.978 105.942 189.958H148.937H188.931L204.929 188.958H238.925L259.922 189.958ZM49.9491 217.955C55.3384 219.485 61.8475 222.584 66.9469 225.064L77.9455 230.263C80.6952 231.523 88.6341 235.402 90.3039 237.562C92.1937 240.012 90.8839 243.072 87.8343 243.431C85.4246 243.721 80.2752 241.232 77.9455 240.232L57.948 231.093C55.6183 229.923 50.209 227.803 49.0092 225.684C47.5893 223.164 48.9692 220.334 49.9491 217.955ZM269.921 235.952C279.04 231.133 299.787 219.605 308.896 217.955C309.336 220.354 310.206 223.344 308.896 225.574C307.716 227.543 303.937 229.543 301.917 230.643L283.919 239.372C281.9 240.252 278.03 242.302 275.96 242.252C272.281 242.172 270.761 238.982 269.921 235.952ZM151.936 229.953C153.786 228.423 155.646 226.414 157.975 225.674L188.931 224.954C206.079 225.154 236.385 233.303 251.923 240.702L270.921 249.491C274.031 250.941 277.74 252.24 278.59 255.99C280 262.279 274.901 261.709 270.921 260.069L241.925 247.271C206.219 234.073 166.694 231.803 129.939 242.382C116.821 246.151 104.342 252.04 91.9437 257.65C89.1341 258.92 81.3951 263.019 78.6154 260.939C76.6957 259.419 77.0656 256.3 78.6154 254.58C80.4652 252.37 87.9542 249.571 90.9439 248.171L113.941 238.472L130.899 233.693L136.218 230.883L145.937 227.953L146.937 229.953H147.937L148.937 226.954L151.936 229.953ZM51.9488 237.952L59.9378 241.512L61.9375 252.95L58.9679 283.946L54.1185 329.941L47.7793 394.932L43.9498 428.928C39.8803 428.498 34.281 426.978 32.5513 422.749C31.5714 420.329 32.7612 413.79 33.1012 410.93L35.9508 383.934L38.7905 354.937L44.7797 298.944L48.7792 258.95C49.4891 251.89 49.7091 244.741 51.9488 237.952ZM313.916 427.928L312.076 409.93L307.086 364.936L298.638 285.946L295.088 252.95C294.508 245.431 299.097 242.722 305.917 241.952L310.746 284.946L316.085 337.939L320.895 382.934L323.114 408.93C323.804 412.43 324.694 420.719 323.114 423.709C321.045 426.778 317.145 427.418 313.916 427.928ZM163.935 250.161H185.932C197.47 249.971 213.268 253.54 223.927 257.96C295.538 287.646 315.295 386.133 256.923 438.757C245.694 448.875 233.206 456.055 218.928 460.924C205.939 465.343 200.24 465.823 186.932 467.093C183.402 467.433 181.792 468.053 177.933 467.833C154.226 466.483 132.669 461.374 112.941 447.486C98.9028 437.607 85.4745 423.369 77.7555 407.931C56.5782 365.576 68.0168 310.483 102.262 278.287C114.731 266.569 132.279 256.91 148.937 252.85L163.935 250.161ZM228.926 270.948C212.918 263.589 208.639 261.549 190.931 259.779L183.932 259.139H177.933H169.934L150.946 261.769C145.377 263.089 145.667 264.999 141.897 266.369L133.938 268.078C130.109 269.488 124.2 272.958 125.849 277.857C126.799 280.687 130.519 282.846 129.609 285.636C128.089 290.266 112.241 292.335 121.09 299.074C122.39 300.064 123.48 300.364 124.94 300.944C127.069 297.795 130.009 292.765 133.938 291.835C136.198 291.295 138.428 292.245 140.518 292.955L146.597 294.965C150.746 297.685 150.356 304.624 149.936 308.943L140.958 306.313L132.809 312.863L126.939 315.782L112.661 328.981L109.941 335.94C102.692 330.84 94.7234 332.62 92.9436 341.939C104.332 342.229 101.692 346.498 102.742 351.938L104.942 358.937L96.8531 353.348L86.3244 348.518L77.9455 337.939C74.266 346.778 74.8359 357.497 74.9459 366.936C75.3358 399.922 100.193 433.477 128.939 447.956C169.334 468.293 221.137 461.734 253.883 429.838C272.071 412.13 283.209 385.263 282.92 359.937C282.87 355.747 281.64 344.269 278.49 341.539C277.16 340.389 268.351 338.569 265.922 337.939C269.821 342.759 271.271 342.419 276.92 343.939C274.951 347.288 264.902 357.237 260.742 355.017C257.543 353.308 257.603 349.118 251.923 345.938C252.833 354.007 257.713 362.436 266.922 359.937C266.892 367.296 260.482 370.925 256.993 376.935C252.993 383.814 254.533 387.303 253.613 390.893C252.773 394.162 250.674 395.252 249.004 398.022C246.444 402.261 247.034 405.791 242.705 410.93C240.485 413.56 235.496 418.639 231.646 417.729C224.327 416.01 220.217 399.512 219.728 392.933C219.528 390.223 220.197 388.443 220.397 385.933C220.607 383.364 220.267 381.424 219.688 378.934C219.258 377.065 218.568 374.625 217.648 372.955C210.219 359.367 196.6 374.955 186.582 362.636C177.753 351.778 186.452 333.37 197.94 328.421C200.94 327.131 210.839 324.211 213.758 325.241C216.398 326.171 220.207 331.41 226.927 330.53L231.926 329.131C234.826 328.771 239.815 328.941 242.925 329.131V325.941C233.506 325.171 237.705 319.312 240.135 318.052C242.845 316.652 244.694 318.652 250.924 316.942C247.774 313.043 242.185 309.023 237.555 313.453C235.246 315.672 233.086 322.911 229.456 321.042L225.927 316.942L220.927 320.942C220.467 319.412 220.427 318.532 219.338 317.172C213.508 309.913 206.479 320.642 201.93 322.181C197.42 323.711 193.771 320.252 195.101 317.162C196.75 313.313 204.189 314.792 202.6 308.003C201.38 302.804 196.41 305.934 194.841 303.424C193.561 301.374 197.82 296.025 198.93 293.945C206.309 298.524 205.469 305.754 211.709 300.514C212.748 299.634 213.128 298.924 213.928 297.945C212.448 296.245 210.459 294.465 210.399 292.035C210.339 289.406 218.318 279.247 220.437 277.547C224.577 274.218 225.987 277.887 228.926 270.948ZM194.931 264.959C192.211 274.208 183.562 280.017 175.933 284.946C173.013 286.826 168.734 290.126 165.464 287.336C160.645 283.416 165.184 277.307 165.464 274.947C166.304 270.218 159.295 265.389 168.934 264.959H171.934H194.931ZM143.937 289.946C140.118 280.437 138.378 282.736 137.168 279.687C136.058 276.897 138.618 272.888 141.887 273.688C145.277 274.518 151.006 282.157 149.546 285.736C148.627 288.006 145.977 288.986 143.937 289.946ZM238.925 281.947C238.055 276.967 236.695 276.757 231.926 275.947C233.496 280.407 234.246 281.167 238.925 281.947ZM223.877 291.145C216.728 293.505 217.828 299.734 222.927 299.154C227.337 298.644 229.716 293.285 223.877 291.145ZM135.938 433.927C129.969 432.118 129.159 428.318 126.799 422.929L120.65 406.931C119.23 401.391 121.02 399.352 116.831 392.933C113.531 387.873 104.652 379.894 103.912 373.935C103.342 369.356 111.021 356.817 116.981 356.097C120.49 355.677 122.82 357.237 125.939 358.297C131.679 360.247 135.728 359.727 140.768 364.276C143.847 367.066 145.777 370.955 149.026 373.215C153.356 376.215 158.225 374.885 161.195 379.074C164.365 383.564 160.355 387.673 158.925 391.933C158.235 393.972 157.945 396.792 156.356 398.332C154.966 399.672 153.666 399.642 151.936 399.932C149.896 415.02 142.447 417.229 139.248 423.029L135.938 433.927ZM252.923 407.931C253.163 405.221 253.413 403.541 254.283 400.932C254.843 399.242 255.563 397.472 256.453 395.932C257.543 394.062 260.642 389.573 263.512 391.103C265.452 392.313 264.392 396.192 263.512 397.932C261.572 403.241 258.683 406.991 252.923 407.931ZM329.854 430.928C330.074 433.027 330.803 436.727 329.854 438.537C328.644 440.646 321.375 444.086 318.915 445.526L286.919 462.174C282.8 464.233 272.071 471.443 268.661 465.773C266.902 462.844 269.761 460.814 271.941 459.394L288.919 450.505L305.917 441.626C312.516 438.147 322.774 431.688 329.854 430.928ZM73.946 462.924L34.951 444.176C31.6714 442.526 22.5925 438.837 26.972 433.537C29.5416 430.428 38.0606 435.637 40.9502 437.037C46.5795 439.767 65.0171 448.585 68.5667 452.255C71.5263 455.305 73.1161 458.834 73.946 462.924ZM30.3815 453.075C34.9109 452.395 38.1106 455.475 38.7105 459.924C39.8903 466.853 36.8107 472.472 38.7105 480.921C40.7602 490.96 46.5095 498.949 53.9485 505.828L62.3575 512.677C64.5772 515.417 62.8474 520.386 59.7378 521.766C55.2484 523.756 43.9998 513.937 40.9602 510.908C28.4618 498.399 24.5523 484.121 26.672 466.923C27.2619 462.134 26.762 456.674 30.3815 453.075ZM327.914 452.925C331.733 474.232 332.063 493.35 315.895 509.918C312.666 513.237 301.307 524.986 296.298 520.546C293.218 517.477 292.758 513.907 296.298 510.808L302.917 505.458C307.986 501.229 314.586 493.19 316.815 486.921C318.085 483.321 318.815 478.732 318.905 474.922C319.125 465.183 313.846 454.895 327.914 452.925ZM78.9454 463.924C81.0951 462.654 83.2748 461.084 85.9245 461.484C91.5538 462.344 90.6439 468.853 84.9446 468.143C83.5548 467.973 80.3652 466.523 78.9454 465.923V463.924ZM53.9985 471.943C57.2481 470.833 60.8077 470.283 63.7973 472.522C68.3167 475.902 67.7568 484.141 62.8374 486.901C54.6785 491.48 43.1799 480.191 53.9985 471.943ZM293.978 471.943C297.168 470.853 300.767 470.263 303.687 472.522C308.616 476.322 307.936 486.511 299.877 487.681C290.449 489.06 286.249 477.972 293.978 471.943ZM97.543 477.942C101.762 476.142 108.272 476.922 112.941 476.922H144.937H254.923C256.913 476.922 260.732 476.692 262.322 477.942C263.352 478.762 263.572 479.762 263.772 480.981C264.182 483.391 264.362 490.28 262.322 491.9C260.732 493.15 256.913 492.92 254.923 492.92H165.934L154.936 492L144.937 492.93H107.942H98.2529C94.4234 491.76 95.6633 480.561 97.543 477.942ZM68.9466 533.915C69.2966 518.377 79.5453 506.158 94.9433 503.149C98.3929 502.759 103.352 502.879 106.942 503.149L121.94 503.918H158.935L175.933 502.919H253.923C266.932 502.939 276 505.358 284.579 515.917C286.959 518.847 293.188 530.695 289.309 533.895C287.779 535.144 283.859 534.915 281.92 534.915H180.932L159.065 533.605C155.966 532.755 155.616 530.615 152.806 529.505L137.938 527.915H94.9433C88.9041 527.915 81.685 526.556 76.9456 530.915L80.9451 532.915L68.9466 533.915ZM121.94 530.915H142.937C146.907 530.925 148.627 530.475 151.936 532.915H121.94V530.915ZM62.2575 543.933C67.0169 542.124 75.6058 542.914 80.9451 542.914H117.94H245.924H292.918C300.407 543.053 299.907 545.173 299.917 551.912V574.909C299.907 576.729 300.067 579.829 298.897 581.309C297.328 583.288 293.218 582.908 290.919 582.908H191.931L176.933 581.909L154.936 580.909H113.941L77.9455 581.669C75.5258 581.809 62.9774 582.878 61.5476 581.669C59.5778 580.419 59.9478 576.099 59.9478 573.91V551.912C59.9778 548.013 59.5378 546.853 62.2575 543.933ZM46.9494 590.387L84.9446 590.907H134.938L151.936 589.908H253.923H273.921L287.919 590.907L301.917 589.908C308.086 589.838 315.565 589.478 320.585 593.707C323.164 595.877 327.824 603.986 324.304 606.885C322.774 608.135 318.855 607.905 316.915 607.905H171.934L156.935 606.905H129.939L112.941 605.906H76.9456L63.9473 606.905H44.9497C43.2499 606.905 39.7303 607.035 38.2605 606.306C35.7309 605.056 36.1108 602.216 36.6407 599.906C38.0406 593.687 41.1202 591.797 46.9494 590.387Z" fill="hsl(49, 80%, 46%)" stroke="hsl(49, 80%, 46%)" stroke-width="0.02"></path></svg>');function Vi(n){var e=Ji();Se(n,e)}var Ki=Ne('<ul class="dropdown svelte-1hhn8qq"><li class="svelte-1hhn8qq"><a class="svelte-1hhn8qq">Light</a></li> <li class="svelte-1hhn8qq"><a class="svelte-1hhn8qq">dark</a></li> <li class="svelte-1hhn8qq"><a class="svelte-1hhn8qq">headache</a></li> <li class="svelte-1hhn8qq"><a class="svelte-1hhn8qq">color blind</a></li></ul>'),Gi=Ne('<div class="navbar svelte-1hhn8qq"><nav class="svelte-1hhn8qq"><ul class="svelte-1hhn8qq"><li class="svelte-1hhn8qq"><button class="dropdown-toggle svelte-1hhn8qq" aria-haspopup="true">Themes</button> <!></li> <li class="svelte-1hhn8qq"><button class="svelte-1hhn8qq"><a href="/about" class="svelte-1hhn8qq">About</a></button></li> <li class="svelte-1hhn8qq"><button class="svelte-1hhn8qq"><a href="/reviews" class="svelte-1hhn8qq">Projects</a></button></li> <li class="svelte-1hhn8qq"><button class="svelte-1hhn8qq"><a href="/services" class="svelte-1hhn8qq">Services</a></button></li> <li class="svelte-1hhn8qq"><button class="svelte-1hhn8qq"><a href="/contact" class="svelte-1hhn8qq">Contact</a></button></li> <li class="svelte-1hhn8qq"><button class="svelte-1hhn8qq"><a href="/" class="svelte-1hhn8qq">Home</a></button></li></ul></nav> <button class="svelte-1hhn8qq"><div class="burger svelte-1hhn8qq"><svg class="svelte-1hhn8qq"><!></svg></div></button></div>');function Wi(n,e){Zt(e,!1);const t=$r(),r=()=>Rr(zi,"$page",t);Xt(()=>{const R=window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.dataset.theme==="dark"||s(R?"dark":"light")});const s=R=>{document.documentElement.dataset.theme=R,document.cookie=`siteTheme${R};max-age=31536000;path=/`};let i=be(!1);function a(R){R.startsWith("/")||R.startsWith("http")?Dr(R,{noScroll:!0}):console.error("Invalid URL:",R)}function o(){A(i,!$(i))}let l=be(0),h=be(!1);Qt();var c=Gi(),u=E(c),f=E(u),d=E(f),g=E(d),v=I(g,2);{var p=R=>{var Le=Ki(),Fe=E(Le),gt=E(Fe);q(gt,"href","#"),T(Fe);var ze=I(Fe,2),vt=E(ze);q(vt,"href","#"),T(ze);var Je=I(ze,2),pt=E(Je);q(pt,"href","#"),T(Je);var _t=I(Je,2),mt=E(_t);q(mt,"href","#"),T(_t),T(Le),O("click",gt,()=>s("light")),O("click",vt,()=>s("dark")),O("click",pt,()=>s("headache")),O("click",mt,()=>s("colorBlind")),Se(R,Le)};Ir(v,R=>{$(h)&&R(p)})}T(d);var b=I(d,2),_=E(b),k=E(_);T(_),T(b);var y=I(b,2),C=E(y),X=E(C);T(C),T(y);var J=I(y,2),M=E(J),Y=E(M);T(M),T(J);var ee=I(J,2),Oe=E(ee),ht=E(Oe);T(Oe),T(ee);var He=I(ee,2),Ae=E(He),ut=E(Ae);T(Ae),T(He),T(f),T(u);var Pe=I(u,2),dt=E(Pe),ft=E(dt),Cr=E(ft);Vi(Cr),T(ft),T(dt),T(Pe),T(c),Or(()=>{te(u,"open",$(i)),q(g,"aria-expanded",$(h)),q(b,"aria-current",r().url.pathname==="/about"?"page":void 0),te(k,"current",$(l)===5),q(y,"aria-current",r().url.pathname==="/reviews"?"page":void 0),te(X,"current",$(l)===4),q(J,"aria-current",r().url.pathname==="/services"?"page":void 0),te(Y,"current",$(l)===3),q(ee,"aria-current",r().url.pathname==="/contact"?"page":void 0),te(ht,"current",$(l)===2),q(He,"aria-current",r().url.pathname==="/"?"page":void 0),te(ut,"current",$(l)===1)}),O("click",g,re(()=>A(h,!$(h)))),O("click",k,re(()=>{A(l,5),a("/about")})),O("click",_,()=>A(i,!1)),O("keydown",_,()=>A(i,!1)),O("click",X,re(()=>{A(l,4),a("/reviews")})),O("click",C,()=>A(i,!1)),O("keydown",C,()=>A(i,!1)),O("click",Y,re(()=>{A(l,3),a("/services")})),O("click",M,()=>A(i,!1)),O("keydown",M,()=>A(i,!1)),O("click",ht,re(()=>{A(l,2),a("/contact")})),O("click",Oe,()=>A(i,!1)),O("keydown",Oe,()=>A(i,!1)),O("click",ut,re(()=>{A(l,1),a("/")})),O("click",Ae,()=>A(i,!1)),O("keydown",Ae,()=>A(i,!1)),O("click",Pe,o),O("keydown",Pe,()=>A(i,!1)),Se(n,c),Wt()}var Zi=Ne('<footer class="svelte-1u145d4"><p class="svelte-1u145d4">Produced by <a href="https://www.lanternlightdevelopment.com/" class="svelte-1u145d4">Lantern Light Development</a></p></footer>');function Qi(n){var e=Zi();Se(n,e)}var Xi=Ne("<!> <!> <!>",1);function _n(n,e){Zt(e,!1);let t=xr(e,"data",8),r=t(),s=be(r.supabase),i=be(r.session);Xt(()=>{const{data:c}=$(s).auth.onAuthStateChange((u,f)=>{var d;(f==null?void 0:f.expires_at)!==((d=$(i))==null?void 0:d.expires_at)&&qr("supabase:auth")});return()=>c.subscription.unsubscribe()}),Ar(()=>($(s),$(i),jr(t())),()=>{(c=>(A(s,c.supabase),A(i,c.session)))(t())}),Pr(),Qt();var a=Xi(),o=Lr(a);Wi(o,{});var l=I(o,2);Mr(l,e,"default",{});var h=I(l,2);Qi(h),Se(n,a),Wt()}export{pn as _,_n as a,Vr as g};
